Day 3
The Grinch has brainstormed a ton of pranks for Whoville, but he only wants to keep the top prank per target, with the highest evilness score. Return the most evil prank for each target. If two pranks have the same evilness, the more recently brainstormed wins.



SELECT target_name, prank_description
FROM (
    SELECT
        target_name,
        prank_description,
        evilness_score,
        created_at,
        ROW_NUMBER() OVER (
            PARTITION BY target_name
            ORDER BY evilness_score DESC, created_at DESC
        ) AS rn
    FROM grinch_prank_ideas
)
WHERE rn = 1;


ANSWER

target_name	prank_description	
Bakery	Replace sugar with salt in all recipes
Church Choir	Train Max to howl during performances
Cindy-Lou	Tell her Santa isn't real
Mayor	Swap his speech with a recipe for roast beast
Post Office	Mix up all the address labels
School	Change all clocks to show wrong time
Town Square	Replace the Christmas tree with a cactus
Toy Factory	Reverse all the assembly line directions
