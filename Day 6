Day 6

Buddy is planning a winter getaway and wants to rank ski resorts by annual snowfall. Can you help him bucket these ski resorts into quartiles?



SELECT 
    resort_name,
    NTILE(4) OVER (ORDER BY total_annual_snowfall DESC ) as resort_snowfall_quartile,
    total_annual_snowfall
FROM
  (
    SELECT 
        resort_id,
        resort_name,
        SUM(snowfall_inches) AS total_annual_snowfall
    FROM resort_monthly_snowfall
    GROUP BY resort_id, resort_name
  )
;


ANSWER:

resort_name	resort_snowfall_quartile	total_annual_snowfall	
Whiteout Peak		1				340.8
Glacier Point		1				320.6
Everest Valley		1				302.5
Frostbite Ridge		1				273.6
Avalanche Alley		1				266.4
Snowbird Summit		2				239.2
Aurora Basin		2				232
Mammoth Heights		2				222.79999999999998
Timber Ridge		2				211.2
Alpine Peaks		2				203.6
Thunder Ridge		3				193.9
Summit Station		3				182.79999999999998
Crystal Mountain	3				175.4
Powder Paradise		3				173.6
Diamond Run		3				160.4
Blizzard Bay		4				148.7
Frozen Falls		4				138
Winter Haven		4				131.70000000000002
Silver Slopes		4				122.8
Iceberg Lodge		4				102.8

